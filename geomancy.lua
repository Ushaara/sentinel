-- geomancy

trigs = trigs or {}
trigs.combat = trigs.combat or {}
trigs.defs = trigs.defs or {}

trigs.combat.geomancy = {
  { id = "meld",
      line = "^(%a+) stomps on the ground and [hH]%a+ eyes shine with an eerie red glow%.$",
      action = function (i, tbl) geomancy_(i, tbl) end,
      notes = "meld" },
  { id = "boulderblast",
      line = "^(%a+) points at the ground until [hH]%a+ finger trembles%.$",
      action = function (i, tbl) geomancy_(i, tbl) end,
      notes = "room damage" },
  { id = "boulderblast_2",
      line = "^The earth rumbles and pushes up a large tainted boulder that vibrates momentarily before exploding into thousands of sharp shards of rock%, which cut into your body%.$",
      action = function (i, tbl) geomancy_(i, tbl) end,
      notes = "damage" },
  { id = "poison",
      line = "^The stinking gas creeps deep down your throat%, making you vomit violently%.$",
      action = function (i, tbl) geomancy_(i, tbl) end,
      notes = "getting hungrier!" },
  -- { id = "dissolve" },
  { id = "tremors",
      line = "^A violent tremor rocks the %a+%, causing the earth to shake and the ground to buck beneath your feet%.$",
      action = function (i, tbl) geomancy_(i, tbl) end,
      notes = "sprawl if levitation stripped, chance to break leg" }, -- WARNING: do not see this line if blind
  { id = "duststorm",
      line = "^Dust suddenly and painfully gusts into your eyes%.$",
      action = function (i, tbl) geomancy_(i, tbl) end,
      notes = "blind, if using trueblind try read to detect" },
  { id = "stonewall",
      line = "^(%a+) faces (%a+) and sharply claps [hH]%a+ hands together%, the sound of which is like two bricks being slammed against each other%.$",
      action = function (i, tbl) geomancy_(i, tbl) end,
      notes = "stonewall" },
  { id = "stonewall_2",
      line = "^The earth erupts and pushes up a massive wall of stone%.$",
      action = function (i, tbl) geomancy_(i, tbl) end,
      notes = "pogos are great!" },
  { id = "stonewall_3",
      line = "^A deep rumbling within the earth makes the ground tremble%.$",
      action = function (i, tbl) geomancy_(i, tbl) end,
      notes = "pogos are great!" },
  { id = "lodestone",
      line = "^A deep%, foreboding hum emanates from the tainted earth%, and then you are suddenly slammed into the ground by an irresistable force%.$",
      action = function (i, tbl) geomancy_(i, tbl) end,
      notes = "sprawled and levitate strip, with 1s stun if no levitate" },
  { id = "stonerain",
      line = "^Hundreds of stones rain down from above%, blocking the exits%.$",
      action = function (i, tbl) geomancy_(i, tbl) end,
      notes = "stonerain" },
  { id = "stonerain_room",
      line = " A pile of rubble lies here%, blocking the way (%a+)%.",
      action = function (i, tbl) geomancy_(i, tbl) end,
      notes = "rubbled room" },
  { id = "stonerain_flying",
      line = "^Black clouds suddenly release hundreds of stones which rain down on you like a blizzard of gray hail%, pummeling you cruelly and driving you to the ground%.$",
      action = function (i, tbl) geomancy_(i, tbl) end,
      notes = "forced elevation change" },
  -- { id = "wyrm" },
  { id = "rockslide",
      line = "^Dust clouds rise as the earth shifts and sharp rocks slide and bounce%, some flying into the air%. You yelp in pain as several of them smash into you%, bruising your flesh and cutting your skin%.$",
      action = function (i, tbl) geomancy_(i, tbl) end,
      notes = "damage" },
  { id = "sickening",
      line = "^Fumes rise up from the tainted earth and make you cough%. Ugly cankerous sores break out on your skin%, dripping with pus%.$",
      action = function (i, tbl) geomancy_(i, tbl) end,
      notes = "sickened, TYPO CHECK" },
  { id = "staff",
      line = "^(%a+) points [hH]%a+ staff at you and it swells%, rapidly discharging a torrent of poisonous fumes and sharp rocks into your body%, engulfing flesh and smashing bone%.$",
      action = function (i, tbl) geomancy_(i, tbl) end,
      notes = "damage" },
  { id = "staff_adjacent",
      line = "^A torrent of poisonous fumes and sharp rocks hurtle at you from the (%a+)%.$",
      action = function (i, tbl) geomancy_(i, tbl) end,
      notes = "damage" },
  { id = "gunk",
      line = "^(%a+) twirls [hH]%a+ staff in front of you%, which spews forth vile black oil that covers you in a sticky morass of filth%.$",
      action = function (i, tbl) geomancy_(i, tbl) end,
      notes = "sludged with gunk, lasts ~60s without cleanse cure" },
  { id = "gunk_symptom",
      line = "^The sticky black gunk slows you down as you squelch to the (%a+)%.$",
      action = function (i, tbl) geomancy_(i, tbl) end,
      notes = "gunk symptom, slowed movement" },
  { id = "gunk_cleared",
      line = "^The vile black gunk that covers your body dissolves%.$",
      action = function (i, tbl) geomancy_(i, tbl) end,
      notes = "gunk cleared by itself" },
  { id = "chasm",
      line = "^(%a+) points at the tainted earth beneath your feet%, snarling with a look of madness on [hH]%a+ face%. The ground begins to tremble%.$",
      action = function (i, tbl) geomancy_(i, tbl) end,
      notes = "timed insta, blind, gust or sleep them to interrupt it!" },
  { id = "chasm_2",
      line = "^(%a+)%'s finger trembles and [sS]?[hH]e bares [hH]%a+ teeth in a hideous grimace%. A small crack appears in the ground beneath you%!$",
      action = function (i, tbl) geomancy_(i, tbl) end,
      notes = "seriously, gtfo while you still can!" },
  { id = "fleshstone",
      line = "^Eyes narrowed in concentration%, (%a+) slams [hH]%a+ palm against your chest%. Your muscles begin to freeze and your skin turns to slate grey%. It dawns on you that you have been turned to stone%, but you are aware of what is going on around you even though you cannot make any action%.$",
      action = function (i, tbl) geomancy_(i, tbl) end,
      notes = "out of phase" },
  { id = "fleshstone_symptom",
      line = "^You have been turned to stone and cannot move%.$",
      action = function (i, tbl) geomancy_(i, tbl) end,
      notes = "out of phase" },
  { id = "pollute",
      line = "^Small fissures open up in the tainted earth%, releasing toxic fumes that blacken the ground and pollute the air%.$",
      action = function (i, tbl) geomancy_(i, tbl) end,
      notes = "big damage incoming, get out of meld" },
  { id = "pollute_2",
      line = "^With a great rumble%, the small fissures on the ground widen to large cracks%, sending great gouts of poisonous clouds roiling and churning into the air%, making breathing difficult and your eyes water painfully%.$",
      action = function (i, tbl) geomancy_(i, tbl) end,
      notes = "get out of meld now!" },
  { id = "pollute_3",
      line = "^The ground convulses and you are no longer able to see through the pitch black clouds that contaminate the air%. The stinking pollution coats your skin%, dissolving your flesh like acid%, and you choke upon the foul fumes that eat away at your lungs%.$",
      action = function (i, tbl) geomancy_(i, tbl) end,
      notes = "ouch, shield if you're still alive!" },
}

trigs.defs.geomancy = {}

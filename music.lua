-- music

trigs = trigs or {}
trigs.combat = trigs.combat or {}
trigs.defs = trigs.defs or {}

trigs.combat.music = {
  { id = "blankchord",
      line = "^(%a+) appears to play .+%, but you hear no sound%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "blankchord" },
  { id = "blankchord_2",
      line = "^You cry out as your deaf ears open up to the sound of a high%-pitched note%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "you got blankchorded" },
  { id = "blanknote",
      line = "^(%a+) plays .+%, and you cry out as your deaf ears open up to the sound of a high%-pitched note%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "truedeaf stripped, earache up" },
  { id = "symptom_earache",
      line = "^The ache in your ear canals suddenly intensifies%, leaving you with nothing but a splitting headache%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "still have earache" },
  { id = "play",
      line = "^(%a+) plays .- and directs the %a+ notes towards you%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "enable following lines" },
  { id = "minorsecond",
      line = "^The reverberating sound echoes through your head%, pounding you with excruciating pain%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "damage, should have prior line" },
  { id = "majorsecond",
      line = "^As the whispers enter your mind%, a sinking feeling drops into the pit of your stomach%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "egovice, damage on ego loss" },
  { id = "symptom_egovice",
      line = "^You hear strange whispers%, and a sharp pain stabs you between the eyes%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "egovice, damage on ego loss" },
  { id = "tritone",
      line = "^Your head begins throbbing to the beat of the ominous noise%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "manabarbs, damage on mana use" },
  { id = "symptom_tritone",
      line = "^You hear an ominous sound%, and a dull pain stab throbs throughout your head%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "manabarbs, damage on mana use" },
  { id = "perfectfifth",
      line = "^The lyrical sound invokes a strange longing for (%a+)%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "can't leave until deaf" },
  { id = "minorsixth",
      line = "^You feel suddenly tired and enervated as the music washes over you%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "mana/ego drain" },
  { id = "minorseventh",
      line = "^You blanch as the high%-pitched screech settles deep within your mind%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "auric damage boosted" },
  { id = "majorseventh",
      line = "^The jarring sound causes a cold pain to stab you in the forehead%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "powerspikes, damage on power loss" },
  { id = "symptom_powerspikes",
      line = "^You hear a dark thrumming%, and pain wracks your entire being%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "damage on power loss" },
  { id = "octave",
      line = "^(%a+) plays .+%, striking a single perfect note that lingers in the air and builds in strength%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "bard putting up octave!" },
  { id = "octave_2",
      line = "^Your entire being quivers as the ringing note in the air suddenly reaches a reverberating harmonic unity%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "octave is up, eating horehound won't cure aurics unless deaf" },
  { id = "octave_3",
      line = "^You breathe a sigh of relief as the reverberating ringing note here fades away%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "octave dropped!" },
  { id = "symptom_octave",
      line = "^A strange vibration prevents you from healing auric ailments%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "horehound cure failed" },
  { id = "discordantchord",
      line = "^(%a+) plays a wailing%, discordant chord on .+%, directing the dissonant notes at you%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "discordant chord!" },
  { id = "discordantchord_2",
      line = "^You scream in agony as (%a+) notes? threatens? to rip you asunder%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "stun if three or more" },
}

trigs.defs.music = {
  { id = "play_fail",
      line = "^What do you want to play%?$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "play fail" },
  { id = "bardicpresence",
      line = "^With a charming flourish%, you bow down deeply%. As you rise up slowly%, your ego swells with the presence of the bardic profession%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "bardicpresence" },
  { id = "bardicpresence_up",
      line = "^You already have a bardic presence%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "bardicpresence up" },
  { id = "bardicpresence_def",
      line = "^You have a bardic presence%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "cha buff" },
  { id = "play_minorsecond",
      line = "^You play a minor second on .- and direct the disharmonic notes towards .-%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "magic damage: Blood trickles out of .-%'s ears and from the corners of [hH]%a+ eyes." },
  { id = "minorsecond",
      line = "^Blood trickles out of (.-)%'s ears and from the corners of [hH]%a+ eyes%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "magic damage" },
  { id = "minorsecond_kill",
      line = "^(.-) screams and dies%, as [hH]%a+ eyes fly out of their sockets and blood splurts out of [hH]%a+ ears%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "minorsecond kill" },
  { id = "majorthird",
      line = "^You play a major third on .- and direct the harmonious notes towards (%a+)%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "majorthird" },
  { id = "majorthird_heal",
      line = "^Your body flushes warmly to the vibrating sound%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "majorthird heal" },
  { id = "instrumentbond",
      line = "^You furiously play .+%, letting the crescendo build and build until the instrument beneath your hands begins to grow warm%. Finally%, you release the sound with a dramatic flourish and feel a deep link between yourself and .-%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "instrument bond" },
  { id = "instrument_call",
      line = "^You hum softly to yourself and lift your arms over your head%. .- shimmers into existence between your outstretched hands%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "call instrument" },
  { id = "play_roulade",
      line = "^You play a rapid succession of tones on .- as you hum a single syllable%, the inspiring melody rousing your ego to greater heights%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "ego restore" },
  { id = "sustain",
      line = "^You slow your playing of your instrument%, and the sound of your song diminishes until the music is too quiet to be heard%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "sustain" },
  { id = "sustain_up",
      line = "^You are already sustaining your song%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "sustain up" },
  { id = "captivated",
      line = "^You focus on your own music until you are captivated by it%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "captivated" },
  { id = "encore",
      line = "^With a deep breath%, you ready yourself to play a rousing encore performance at a tempo accelerando%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "encore" },
  { id = "encore_up",
      line = "^You are already playing an encore performance%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "encore up" },
  { id = "encore_down",
      line = "^You let out a breath as your encore ends%, returning your performance to normal tempo%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "encore down" },
  { id = "org_song",
      line = "^The music here inspires you to greater heights%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "dmp buff" },
  { id = "songstat",
      line = '^You are currently on the (%d)%a+ stanza of %"(%a+)%"%.',
      action = function (i, tbl) music_(i, tbl) end,
      notes = "songstat" },
  { id = "songstat_sustain",
      line = "^You are currently sustaining your performance%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "song is sustained" },
  { id = "songstat_timer",
      line = "^Without further performance%, the song will end in (%d+) seconds%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "song timer" },
  { id = "sing",
      line = '^%".-%" you sing%, playing .-%.',
      action = function (i, tbl) music_(i, tbl) end,
      notes = "sing nothing imbued" },
  { id = "song_end",
      line = '^The song %"(%a+)%" ends and fades away%.$',
      action = function (i, tbl) music_(i, tbl) end,
      notes = "song ended" },
  { id = "songstat_nosong",
      line = "^You are not performing a song%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "not singing" },
  { id = "refrain_fail",
      line = "^You must start a song before being able to play a refrain%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "not singing" },
  { id = "play_tritone",
      line = "^You play a tritone on .- and direct the ominous notes towards (%a+)%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "has following line" },
  { id = "play_tritone_success",
      line = "^A strange green hue flashes over %a+%'s face%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "tritoned" },
  { id = "tritone",
      line = "^Green smoke leaks out of (%a+)%'s ears%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "tritoned" },
  { id = "majorsixth_initiate",
      line = "^You play a major sixth on .- and let the haunting notes travel to the milestone%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "don't interrupt" },
  { id = "majorsixth_finish",
      line = '^You are drawn through the aetherways by the sound emanating from a small milestone bearing the name %"%a+%"%.$',
      action = function (i, tbl) music_(i, tbl) end,
      notes = "music teleport" },
  { id = "majorsixth",
      line = "^You are drawn through the aetherways by the sound emanating from a crystalline milestone%.$",
      action = function (i, tbl) music_(i, tbl) end,
      notes = "music teleport" },
}
